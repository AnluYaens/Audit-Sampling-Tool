<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anomalyze - Home</title>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Toastify CSS -->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <header>
      <div class="logo">Anomalyze</div>
      <nav data-auth-nav data-auth-state="guest">
        <a href="index.html">Home</a>
        <div class="nav-auth nav-profile">
          <button type="button" class="user-pill" data-user-toggle>
            <span class="user-pill-label" data-user-name>Profile</span>
            <span class="user-pill-initials" data-user-initials>PR</span>
            <span class="user-pill-caret">▾</span>
          </button>
          <div class="user-menu" data-user-menu hidden>
            <div class="user-menu-section" data-menu-user hidden>
              <div class="user-menu-header">
                <p class="user-menu-name" data-user-menu-name>Account</p>
                <p class="user-menu-email" data-user-menu-email></p>
              </div>
              <button type="button" class="user-menu-btn" data-profile-btn>
                Profile
              </button>
              <button type="button" class="user-menu-btn" data-settings-btn>
                Settings
              </button>
              <div class="user-menu-divider"></div>
              <button
                type="button"
                class="user-menu-btn danger"
                data-logout-btn
              >
                Log out
              </button>
            </div>
            <div class="user-menu-section" data-menu-guest>
              <p class="user-menu-name">Welcome</p>
              <p class="user-menu-email muted">
                Sign in to access your workspace.
              </p>
              <button type="button" class="user-menu-btn" data-login-btn>
                Log in
              </button>
              <button type="button" class="user-menu-btn" data-signup-btn>
                Sign up
              </button>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="main-content">
      <!-- Hero Section -->
      <section class="hero-section">
        <h1 class="hero-title">Audit smarter. Not harder.</h1>
        <p class="hero-subtitle">
          AI-driven anomaly detection for smarter audits
        </p>
      </section>

      <!-- Upload CSV Card -->
      <section class="upload-section">
        <div class="upload-card">
          <h2 class="upload-title">Upload CSV</h2>
          <form id="upload-form" class="upload-form">
            <div class="upload-button-wrapper">
              <button type="button" class="btn-upload" id="upload-trigger">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="17 8 12 3 7 8"></polyline>
                  <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                Upload
                <span class="upload-indicator">●</span>
              </button>
              <input
                type="file"
                id="csv-file"
                accept=".csv,text/csv"
                style="display: none"
              />
              <button
                id="upload-form-submit"
                type="submit"
                style="display: none"
                aria-hidden="true"
              ></button>
            </div>
          </form>
          <p class="upload-info">Supported formats: CSV | Max size 15 MB</p>
          <div class="upload-progress" id="upload-progress" aria-hidden="true">
            <span></span>
          </div>
          <div
            id="upload-status"
            class="upload-status"
            aria-live="polite"
          ></div>
          <div
            id="upload-error"
            class="upload-error"
            aria-live="assertive"
          ></div>
          <div class="preview-wrap">
            <div id="preview-meta" class="preview-meta"></div>
            <table id="preview-table" class="preview-table"></table>
          </div>
        </div>
      </section>

      <!-- Process Steps -->
      <section class="steps-section">
        <div class="steps-container">
          <span class="step">1. Upload data</span>
          <span class="arrow">→</span>
          <span class="step">2. Generate sample</span>
          <span class="arrow">→</span>
          <span class="step">3. Detect anomalies</span>
          <span class="arrow">→</span>
          <span class="step">4. Export report</span>
        </div>
      </section>

      <!-- Features Grid -->
      <section class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
              <path d="M13 2L3 14h8l-1 8 10-12h-8l1-8z" />
            </svg>
          </div>
          <h3 class="feature-title">Fast Sampling</h3>
          <p class="feature-description">
            Quickly create representative samples
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
              <circle cx="12" cy="12" r="10" />
              <circle cx="9" cy="9" r="1.5" fill="#0a0e27" />
              <circle cx="15" cy="9" r="1.5" fill="#0a0e27" />
              <path
                d="M8 14s1.5 2 4 2 4-2 4-2"
                stroke="#0a0e27"
                stroke-width="1.5"
                fill="none"
              />
            </svg>
          </div>
          <h3 class="feature-title">AI Detection</h3>
          <p class="feature-description">
            Identify outliers with machine learning
          </p>
        </div>

        <div class="feature-card">
          <div class="feature-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
              <rect x="3" y="3" width="7" height="7" />
              <rect x="14" y="3" width="7" height="7" />
              <rect x="14" y="14" width="7" height="7" />
              <rect x="3" y="14" width="7" height="7" />
            </svg>
          </div>
          <h3 class="feature-title">Clear Reports</h3>
          <p class="feature-description">
            Generate detailed audit documentation
          </p>
        </div>
      </section>

      <!-- Connect Section -->
      <section class="connect-section">
        <div class="connect-card">
          <h2 class="connect-title">Connect with us</h2>
          <p class="connect-subtitle">Reach out for support or inquiries</p>
          <a href="contact.html" class="btn-contact">Contact</a>
        </div>
      </section>
    </main>

    <script src="js/script.js"></script>
    <!-- Toastify JS -->
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/toastify-js"
    ></script>
    <script type="module">
      import { initCsvUpload } from "./js/upload.js";

      const requireUploadAuth =
        typeof window.requireLoginForAction === "function"
          ? () => window.requireLoginForAction("upload a CSV")
          : () => true;

      initCsvUpload({ requireAuth: requireUploadAuth, showPreview: false });
      const trigger = document.getElementById("upload-trigger");
      const input = document.getElementById("csv-file");
      const form = document.getElementById("upload-form");
      const submitProxy = document.getElementById("upload-form-submit");
      const submitUploadForm = () => {
        if (!form) return;
        if (typeof form.requestSubmit === "function") {
          form.requestSubmit(submitProxy || undefined);
        } else {
          form.dispatchEvent(
            new Event("submit", { bubbles: true, cancelable: true })
          );
        }
      };
      trigger?.addEventListener("click", () => {
        if (requireUploadAuth()) {
          input?.click();
        }
      });
      input?.addEventListener("change", submitUploadForm);
    </script>
  </body>
</html>
